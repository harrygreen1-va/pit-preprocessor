insert into score_reason (claim_key, claim_detail_key, reason_score, reason_code, is_current, start_date, cst_job_id,
                          eci_id, score_date_key, profile_id, threshold)
select f.claim_key,
       f.claim_detail_key,
       -50,
       'DQ00006',
       'Y',
       GETDATE(),
       @p0,
       @p1,
       GETDATE(),
       'Rules',
       0
from f_professional_medical_claim_details f
         join dim_va_claim vac on f.claim_key = vac.claim_key
         join dim_patient p on vac.patient_key = p.patient_key
where member_id = '999999999'
  and f.etl_batch_id in (select etl_batch_id from claim_batch_log where eci_id = @p2 and to_score_indicator = 'Y')


select fcd.claim_detail_key
from f_institutional_medical_claim_details fcd
         join dim_va_claim vac on vac.claim_key = fcd.claim_key
         join dim_patient pat on pat.patient_key = vac.patient_key
         join @ids pids on pids.id = pat.member_id
where fcd.is_current = 'Y'
option (maxdop 1)

select *
from vw_institutional_claim
where claim_line_number in (select id from #claimlinekeys) Executing selectClaimsForPatients (?,?,?) Professional
with earliest visit/service date  Mon Mar 04 00:00:00 CST 2019 for the following patient
ids: 179548162,006481758,232649872,231735663,522562267,510540578,121648674,005289376,002701417,123803952,517529866,214464886,458634618,562080977,028288204,523564781,340447036,014582675,023381768,298508917,053265140,151606507,432722475,250619251,471987931,093527846,267803714,427701713,158645783,435910406,048847915,510468639,002304321,506962080,521601763,485521278,073727721,476400869,556119929,062425541,477060225,259712131,443360331,243118845,243757469,599073911,431589283,112488288,428652912,549885968,469727418,265773670,479540619,448366585,479116849,044380048,162329861,052385140,044826027,249928393,187400952,504257827,044343011,060464686,575425560,524680078,182562635,051303495,243686562,130387611,210661309,204580400,470481589,574741731,555650410,505725588,555987665,217421285,466385119,565640955,535173041,529299635,141422173,143601296,528808563,224840819,208488316,477420364,330545481,561824347,122428441,155429608,550040329,217445251,524667332,405748283,386545792,009282053,487589161,250693157,132385512,523417367,188407459,460523153,553808910,426967316,436920691,047681414,202327397,165467019,495563784,552642178,520709158,527593935,241702656,004422016,340281334,229115188,605664188,028349615,041581269,239542099,241724795,237943586,144383961,398748971,449134242,053566286,524454993,517808814,354445392,175461561,142627426,467794554,040269592,055405559,042444007,494681199,526231668,131385676,556876548,197409173,512741108,227470122,071705924,023368828,031203433,550150192,528601437,507589235,219212374,567635342,224668901,224583555,025449521,220529203,407541553,243153241,206409881,082548203,277686219,482646398,373704670,507362777,193420708,456687917,472621131,188601158,009282160,475944954,162580001,516424980,449687139,008546120,278563704,141603586,605649294,215667719,228805040,224749087,246983798,211644271,172465429,608406260,072485096,528434122,504688260,240048106,484547010,077600649,198461707,479586045,600444976,226808487,197387381,542421366,101682873,236742849,517963076,243517737,182429804,199662485,231782005,135646986,067464222,520287119,516808984,357249561,481587440,005420668,037423296,002581053,028602408,439568746,625090848,410324764,573731766,021347480,330484252,521647332,234669152,279500242,237487710,083367534,517540178,002400104,301488716,185341196,241944873,171382243,240234884,216700370,481866697,477588171,456575298,153460412,108368307,476808917,173629331,170380097,197529133,322407888,214523749,324389126,192385562,224644952,211360766,297702663,533502307,474702852,622070504,430173763,091228763,506506683,175328826,430748477,246981280,170406732,230664091,182503630,119501305,608347485,027229321,183389046,004867119,642037635,601668409,299324867,244902521,231578033,482624993,396560393,463377720,217827133,196486494,138461529,027565434,034441704,042601784,230627154,520567206,524413288,444421684,238192109,174245521,241966976,230688869,179548132,232767217,479743336,522757375,002409004,529649252,167445977,237908774,174681886,521647371,235583019,165240323


select *
from vw_professional_claim
where visit_date >= @earliestvisitservicedate
  and claim_line_number in (select id from #claimlinekeys) [7/16/20 20:28:12:335 CDT] 0000029e SystemOut     O 2020-07-16 20
:28
:12.335  INFO decisionmodel      --- [AThreadPool : 9] com.ibm.va.pit.scoring.io.PitedrDAO      : Executing selectClaimsForPatients (?,?,?)
-- Professional with earliest visit/service date  Fri Mar 01 00:00:00 CST 2019 for the following patient IDs:
-- 179548162,030204039,232649872,231735663,510540578,496244570,472586334,123803952,517529866,458634618,562080977,224701080,523564781,472440736,236823069,432722475,250619251,585016463,471987931,093527846,267803714,486580215,031347243,009260748,010442215,215268656,158645783,478880746,435910406,504448514,002304321,521601763,568334798,073727721,476400869,235345916,459089823,062425541,030446394,477060225,245684420,245442998,443360331,523588765,087203451,599073911,431589283,143346459,038349562,112488288,401668188,549885968,469727418,244047875,479540619,479116849,561415389,044380048,162329861,044826027,249928393,237086201,504257827,060464686,524680078,182562635,243686562,130387611,399386811,574741731,220385270,505725588,555987665,217421285,208488316,122428441,244309448,201305281,217445251,247043812,132385512,188407459,553808910,236629584,165467019,546864702,495563784,429743155,438604234,567082744,352788707,517527275,237943586,449134242,053566286,524454993,158403423,517808814,354445392,175461561,246802805,235064306,467794554,008247057,055405559,195366729,545357336,485486321,020589815,131385676,556876548,227470122,238760315,478045319,023368828,031203433,407541553,243153241,206409881,082548203,482646398,009282160,475944954,516424980,449687139,235040356,228805040,224749087,072485096,504688260,240048106,077600649,004300460,479586045,600444976,226808487,236742849,517963076,243517737,182429804,199662485,231782005,135646986,516808984,436861638,155588324,439568746,013381959,330484252,322346324,025340112,141409253,437533500,238424756,501428618,477588171,108368307,476808917,470503442,623621128,322407888,214523749,324389126,192385562,211360766,297702663,149326664,533502307,474702852,243432248,430173763,506506683,132529868,170406732,230664091,436680247,060381742,135585515,004867119,642037635,526584719,244902521,516363452,539626440,396560393,463377720,195342708,196486494,481829603,523501171,246922696,436765786,001824448,235742939,179548132,571937752,479743336,522698584,522757375,034308812,529649252,222428537,061329075,174681886,235583019,165240323,439806368,006481758,522562267,215425926,121648674,005289376,002701417,358187574,214464886,028288204,340447036,014582675,023381768,298508917,053265140,151606507,026229291,484669629,504605838,242228731,427701713,236485190,150523703,048847915,510468639,019503847,506962080,485521278,088386695,556119929,065506943,422021377,259712131,243118845,243757469,479721918,424741385,455541225,428652912,265773670,448366585,052385140,187400952,044343011,575425560,051303495,210661309,025340185,144348855,180383357,230928228,204580400,470481589,555650410,476581716,466385119,565640955,535173041,463760006,048821353,529299635,250969386,141422173,143601296,528808563,233403005,224840819,333322867,477420364,187407448,330545481,561824347,155429608,550040329,516529473,524667332,528603355,405748283,386545792,239904443,009282053,487589161,250693157,003483280,523417367,460523153,426967316,436920691,047681414,202327397,500563444,191405045,552642178,445227867,520709158,562584097,527593935,241702656,004422016,340281334,229115188,605664188,502269353,028349615,041581269,239542099,124546161,241724795,020467414,144383961,398748971,437787018,469583103,133369255,009524325,142627426,436824913,245745836,226965309,016346109,235847226,040269592,096363370,189369524,042444007,494681199,526231668,197409173,512741108,093344690,013320924,071705924,493864305,562560810,137529056,231987270,550150192,528601437,507589235,219212374,567635342,224668901,224583555,025449521,476481236,220529203,241944823,516302440,246981244,089489019,277686219,226884455,373704670,257608150,507362777,193420708,456687917,472621131,188601158,415086398,162580001,392406348,148461537,141603586,008546120,278563704,517241623,605649294,611287256,437968337,215667719,107222067,019464552,506262032,246983798,211644271,440703404,172465429,245706209,608406260,223622828,528434122,484547010,240702743,198461707,197387381,542421366,101682873,485586947,067464222,520287119,234066286,480785505,357249561,263786515,481587440,005420668,037423296,002581053,028602408,052582442,625090848,410324764,297364029,239578742,573731766,021347480,228372209,521647332,234669152,279500242,237487710,083367534,517540178,012222889,002400104,229687632,301488716,266445545,185341196,241944873,470743406,171382243,240234884,216700370,481866697,151447486,456575298,153460412,173629331,205202397,170380097,197529133,569718440,224644952,521706178,340163890,453218378,102427613,129369318,622070504,091228763,175328826,430748477,042446697,246981280,182503630,119501305,023521013,608347485,027229321,183389046,526680324,264083119,139600123,471728230,522348601,158283952,523407998,601668409,237823370,299324867,261945071,231578033,482624993,438942391,217827133,120506717,138461529,229807838,155263911,027565434,034441704,042601784,230627154,008382455,520567206,524440883,524413288,442425945,444421684,238192109,174245521,241966976,529189210,003409346,230688869,030446073,232767217,240700411,002409004,167445977,237908774,521647371

select *
from vw_institutional_claim
where visit_date >= @earliestvisitservicedate
  and claim_line_number in (select id from #claimlinekeys)


select *
from vw_professional_claim
where visit_date >= @earliestvisitservicedate
  and claim_line_number in (select id from #claimlinekeys)

select fcd.claim_detail_key
from f_professional_medical_claim_details fcd
         join dim_va_claim vac on vac.claim_key = fcd.claim_key
         join dim_patient pat on pat.patient_key = vac.patient_key
         join @ids pids on pids.id = pat.member_id
where fcd.is_current = 'Y'
option (maxdop 1)